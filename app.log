2025-08-13 09:23:49,550 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:23:49,550 - app.main - INFO - Configuration validated successfully
2025-08-13 09:24:20,525 - app.services.database_service - INFO - Database connection established
2025-08-13 09:24:20,545 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 09:24:20,545 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:24:20,546 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 09:24:20,546 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:24:20,547 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 09:24:20,547 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:24:20,548 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:24:20,548 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:24:20,548 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 09:24:20,567 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:24:20,571 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:24:20,571 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:24:20,571 - sqlalchemy.engine.Engine - INFO - [cached since 0.02362s ago] ()
2025-08-13 09:24:20,573 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:24:27,494 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:24:28,466 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:24:28,466 - app.main - INFO - Configuration validated successfully
2025-08-13 09:24:31,439 - app.services.database_service - INFO - Database connection established
2025-08-13 09:24:31,454 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 09:24:31,454 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:24:31,456 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 09:24:31,456 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:24:31,457 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 09:24:31,457 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:24:31,457 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:24:31,458 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:24:31,458 - sqlalchemy.engine.Engine - INFO - [generated in 0.00010s] ()
2025-08-13 09:24:31,464 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:24:31,467 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:24:31,467 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:24:31,467 - sqlalchemy.engine.Engine - INFO - [cached since 0.00915s ago] ()
2025-08-13 09:24:31,468 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:24:34,116 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:24:34,117 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:24:34,117 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] ('fall_compliance_events',)
2025-08-13 09:24:34,122 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:24:34,124 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:24:34,124 - sqlalchemy.engine.Engine - INFO - [cached since 0.007768s ago] ('fall_compliance_events',)
2025-08-13 09:24:34,131 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM fall_compliance_events
2025-08-13 09:24:34,131 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-08-13 09:24:34,133 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:24:34,134 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM fall_compliance_events
2025-08-13 09:24:34,134 - sqlalchemy.engine.Engine - INFO - [cached since 0.002841s ago] ()
2025-08-13 09:24:34,136 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:24:34,138 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:24:34,138 - sqlalchemy.engine.Engine - INFO - SELECT * FROM fall_compliance_events LIMIT 50
2025-08-13 09:24:34,138 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-08-13 09:24:34,141 - app.services.database_service - INFO - Fetched 50 rows from table fall_compliance_events
2025-08-13 09:24:34,141 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:24:36,701 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:24:36,702 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:24:36,702 - sqlalchemy.engine.Engine - INFO - [cached since 2.586s ago] ('fall_incidents_primary',)
2025-08-13 09:24:36,703 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:24:36,703 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:24:36,703 - sqlalchemy.engine.Engine - INFO - [cached since 2.587s ago] ('fall_incidents_primary',)
2025-08-13 09:24:36,710 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM fall_incidents_primary
2025-08-13 09:24:36,711 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ()
2025-08-13 09:24:36,711 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM fall_incidents_primary
2025-08-13 09:24:36,712 - sqlalchemy.engine.Engine - INFO - [cached since 0.001418s ago] ()
2025-08-13 09:24:36,713 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:24:36,714 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:24:36,716 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:24:36,717 - sqlalchemy.engine.Engine - INFO - SELECT * FROM fall_incidents_primary LIMIT 50
2025-08-13 09:24:36,717 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ()
2025-08-13 09:24:36,721 - app.services.database_service - INFO - Fetched 50 rows from table fall_incidents_primary
2025-08-13 09:24:36,721 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:24:49,397 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:24:49,401 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:24:49,401 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:24:49,401 - sqlalchemy.engine.Engine - INFO - [cached since 15.28s ago] ('["fall_compliance_events"',)
2025-08-13 09:24:49,416 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:24:49,416 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ()
2025-08-13 09:24:49,417 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:24:49,418 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:24:49,418 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:24:49,418 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:24:49,418 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:24:49,418 - sqlalchemy.engine.Engine - INFO - [cached since 15.3s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:24:49,421 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:24:49,421 - sqlalchemy.engine.Engine - INFO - [generated in 0.00015s] ()
2025-08-13 09:24:49,422 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:24:49,422 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:24:49,422 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:24:49,422 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:24:49,423 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:24:53,450 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:24:53,454 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:24:53,455 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:24:53,455 - sqlalchemy.engine.Engine - INFO - [cached since 19.34s ago] ('["fall_compliance_events"',)
2025-08-13 09:24:53,468 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:24:53,468 - sqlalchemy.engine.Engine - INFO - [cached since 4.053s ago] ()
2025-08-13 09:24:53,470 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:24:53,470 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:24:53,471 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:24:53,471 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:24:53,472 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:24:53,472 - sqlalchemy.engine.Engine - INFO - [cached since 19.36s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:24:53,477 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:24:53,477 - sqlalchemy.engine.Engine - INFO - [cached since 4.056s ago] ()
2025-08-13 09:24:53,478 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:24:53,479 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:24:53,479 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:24:53,479 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:24:53,479 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:27:03,441 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:27:03,443 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:27:03,444 - sqlalchemy.engine.Engine - INFO - [cached since 152s ago] ()
2025-08-13 09:27:03,446 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:27:04,789 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:27:04,789 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:27:04,790 - sqlalchemy.engine.Engine - INFO - [cached since 153.3s ago] ()
2025-08-13 09:27:04,796 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:27:05,719 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:27:05,720 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:27:05,720 - sqlalchemy.engine.Engine - INFO - [cached since 154.3s ago] ()
2025-08-13 09:27:05,721 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:27:05,872 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:27:05,873 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:27:05,873 - sqlalchemy.engine.Engine - INFO - [cached since 154.4s ago] ()
2025-08-13 09:27:05,875 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:27:06,030 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:27:06,031 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:27:06,031 - sqlalchemy.engine.Engine - INFO - [cached since 154.6s ago] ()
2025-08-13 09:27:06,032 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:27:06,164 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:27:06,165 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:27:06,165 - sqlalchemy.engine.Engine - INFO - [cached since 154.7s ago] ()
2025-08-13 09:27:06,166 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:27:06,307 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:27:06,308 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:27:06,308 - sqlalchemy.engine.Engine - INFO - [cached since 154.9s ago] ()
2025-08-13 09:27:06,309 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:27:06,925 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:27:06,925 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:27:06,926 - sqlalchemy.engine.Engine - INFO - [cached since 155.5s ago] ()
2025-08-13 09:27:06,927 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:27:06,929 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:27:06,929 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:27:06,929 - sqlalchemy.engine.Engine - INFO - [cached since 155.5s ago] ()
2025-08-13 09:27:06,930 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:27:10,938 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:27:10,939 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:27:10,939 - sqlalchemy.engine.Engine - INFO - [cached since 156.8s ago] ('fall_compliance_events',)
2025-08-13 09:27:10,942 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:27:10,942 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:27:10,942 - sqlalchemy.engine.Engine - INFO - [cached since 156.8s ago] ('fall_compliance_events',)
2025-08-13 09:27:10,947 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM fall_compliance_events
2025-08-13 09:27:10,947 - sqlalchemy.engine.Engine - INFO - [cached since 156.8s ago] ()
2025-08-13 09:27:10,947 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM fall_compliance_events
2025-08-13 09:27:10,947 - sqlalchemy.engine.Engine - INFO - [cached since 156.8s ago] ()
2025-08-13 09:27:10,948 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:27:10,948 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:27:10,951 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:27:10,951 - sqlalchemy.engine.Engine - INFO - SELECT * FROM fall_compliance_events LIMIT 50
2025-08-13 09:27:10,951 - sqlalchemy.engine.Engine - INFO - [cached since 156.8s ago] ()
2025-08-13 09:27:10,956 - app.services.database_service - INFO - Fetched 50 rows from table fall_compliance_events
2025-08-13 09:27:10,956 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:29:39,619 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:29:39,621 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:29:39,621 - sqlalchemy.engine.Engine - INFO - [cached since 308.2s ago] ()
2025-08-13 09:29:39,626 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:29:50,600 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:29:50,601 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:29:50,601 - sqlalchemy.engine.Engine - INFO - [cached since 319.1s ago] ()
2025-08-13 09:29:50,607 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:29:52,214 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:29:52,214 - sqlalchemy.engine.Engine - INFO - 
                SELECT table_name 
                FROM information_schema.tables 
                WHERE table_schema = 'public'
                ORDER BY table_name
            
2025-08-13 09:29:52,214 - sqlalchemy.engine.Engine - INFO - [cached since 320.8s ago] ()
2025-08-13 09:29:52,216 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:29:54,931 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:29:54,934 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:29:54,934 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:29:54,935 - sqlalchemy.engine.Engine - INFO - [cached since 320.8s ago] ('["fall_compliance_events"',)
2025-08-13 09:29:54,946 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:29:54,946 - sqlalchemy.engine.Engine - INFO - [cached since 305.5s ago] ()
2025-08-13 09:29:54,948 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:29:54,948 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:29:54,948 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:29:54,949 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:29:54,949 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:29:54,949 - sqlalchemy.engine.Engine - INFO - [cached since 320.8s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:29:54,958 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:29:54,958 - sqlalchemy.engine.Engine - INFO - [cached since 305.5s ago] ()
2025-08-13 09:29:54,959 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:29:54,959 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:29:54,959 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:29:54,959 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:29:54,959 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:13,350 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:38:13,350 - app.main - INFO - Configuration validated successfully
2025-08-13 09:38:16,904 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:38:16,952 - app.services.database_service - INFO - Database connection established
2025-08-13 09:38:16,980 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 09:38:16,980 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:38:16,982 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 09:38:16,982 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:38:16,982 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 09:38:16,982 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:38:16,983 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:16,983 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:16,983 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s] ('["fall_compliance_events"',)
2025-08-13 09:38:16,993 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:38:16,993 - sqlalchemy.engine.Engine - INFO - [generated in 0.00016s] ()
2025-08-13 09:38:16,995 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:16,995 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:16,995 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:16,996 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:16,996 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:16,996 - sqlalchemy.engine.Engine - INFO - [cached since 0.01326s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:38:16,999 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:38:16,999 - sqlalchemy.engine.Engine - INFO - [generated in 0.00012s] ()
2025-08-13 09:38:17,000 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:17,000 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:17,000 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:17,000 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:17,000 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:29,915 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:38:29,917 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:29,918 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:29,918 - sqlalchemy.engine.Engine - INFO - [cached since 12.93s ago] ('["fall_compliance_events"',)
2025-08-13 09:38:29,922 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:38:29,922 - sqlalchemy.engine.Engine - INFO - [cached since 12.93s ago] ()
2025-08-13 09:38:29,924 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:29,925 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:29,926 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:29,927 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:29,927 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:29,928 - sqlalchemy.engine.Engine - INFO - [cached since 12.94s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:38:29,932 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:38:29,932 - sqlalchemy.engine.Engine - INFO - [cached since 12.93s ago] ()
2025-08-13 09:38:29,934 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:29,934 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:29,934 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:29,935 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:29,935 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:30,672 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:38:30,674 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:30,675 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:30,675 - sqlalchemy.engine.Engine - INFO - [cached since 13.69s ago] ('["fall_compliance_events"',)
2025-08-13 09:38:30,679 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:38:30,679 - sqlalchemy.engine.Engine - INFO - [cached since 13.69s ago] ()
2025-08-13 09:38:30,681 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:30,682 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:30,682 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:30,683 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:30,684 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:30,684 - sqlalchemy.engine.Engine - INFO - [cached since 13.7s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:38:30,688 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:38:30,689 - sqlalchemy.engine.Engine - INFO - [cached since 13.69s ago] ()
2025-08-13 09:38:30,690 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:30,690 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:30,690 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:30,691 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:30,691 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:31,562 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:38:31,564 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:31,565 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:31,565 - sqlalchemy.engine.Engine - INFO - [cached since 14.58s ago] ('["fall_compliance_events"',)
2025-08-13 09:38:31,566 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:38:31,566 - sqlalchemy.engine.Engine - INFO - [cached since 14.57s ago] ()
2025-08-13 09:38:31,567 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:31,568 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:31,568 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:31,569 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:31,569 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:31,569 - sqlalchemy.engine.Engine - INFO - [cached since 14.59s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:38:31,570 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:38:31,570 - sqlalchemy.engine.Engine - INFO - [cached since 14.57s ago] ()
2025-08-13 09:38:31,571 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:31,571 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:31,572 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:31,572 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:31,572 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:31,844 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:38:31,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:31,846 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:31,847 - sqlalchemy.engine.Engine - INFO - [cached since 14.86s ago] ('["fall_compliance_events"',)
2025-08-13 09:38:31,848 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:38:31,848 - sqlalchemy.engine.Engine - INFO - [cached since 14.85s ago] ()
2025-08-13 09:38:31,849 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:31,849 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:31,849 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:31,850 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:31,850 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:31,850 - sqlalchemy.engine.Engine - INFO - [cached since 14.87s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:38:31,851 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:38:31,852 - sqlalchemy.engine.Engine - INFO - [cached since 14.85s ago] ()
2025-08-13 09:38:31,853 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:31,853 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:31,853 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:31,854 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:31,854 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:31,988 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:38:31,989 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:31,992 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:31,993 - sqlalchemy.engine.Engine - INFO - [cached since 15.01s ago] ('["fall_compliance_events"',)
2025-08-13 09:38:31,994 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:38:31,995 - sqlalchemy.engine.Engine - INFO - [cached since 15s ago] ()
2025-08-13 09:38:31,996 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:31,997 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:31,997 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:31,998 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:31,998 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:31,999 - sqlalchemy.engine.Engine - INFO - [cached since 15.02s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:38:32,000 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:38:32,000 - sqlalchemy.engine.Engine - INFO - [cached since 15s ago] ()
2025-08-13 09:38:32,001 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:32,001 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:32,001 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:32,001 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:32,001 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:32,504 - app.services.chatbot_service - INFO - Reloading database data...
2025-08-13 09:38:32,506 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:32,507 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:32,508 - sqlalchemy.engine.Engine - INFO - [cached since 15.52s ago] ('["fall_compliance_events"',)
2025-08-13 09:38:32,509 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:38:32,509 - sqlalchemy.engine.Engine - INFO - [cached since 15.52s ago] ()
2025-08-13 09:38:32,511 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:32,511 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:32,512 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:32,513 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:32,513 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:32,513 - sqlalchemy.engine.Engine - INFO - [cached since 15.53s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:38:32,514 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:38:32,515 - sqlalchemy.engine.Engine - INFO - [cached since 15.52s ago] ()
2025-08-13 09:38:32,515 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:32,516 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:32,516 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:41,133 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 09:38:41,135 - app.services.chatbot_service - INFO - Database data reloaded successfully
2025-08-13 09:38:45,590 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:38:45,591 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:45,591 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:45,591 - sqlalchemy.engine.Engine - INFO - [cached since 28.61s ago] ('["fall_compliance_events"',)
2025-08-13 09:38:45,592 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:38:45,592 - sqlalchemy.engine.Engine - INFO - [cached since 28.6s ago] ()
2025-08-13 09:38:45,594 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:45,594 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:45,595 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:45,595 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:45,595 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:45,595 - sqlalchemy.engine.Engine - INFO - [cached since 28.61s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:38:45,596 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:38:45,596 - sqlalchemy.engine.Engine - INFO - [cached since 28.6s ago] ()
2025-08-13 09:38:45,596 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:45,596 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:45,596 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:45,596 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:45,597 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:50,043 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:38:50,045 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:50,046 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:50,046 - sqlalchemy.engine.Engine - INFO - [cached since 33.06s ago] ('["fall_compliance_events"',)
2025-08-13 09:38:50,047 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:38:50,048 - sqlalchemy.engine.Engine - INFO - [cached since 33.05s ago] ()
2025-08-13 09:38:50,049 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:50,049 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:50,050 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:50,051 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:38:50,051 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:38:50,051 - sqlalchemy.engine.Engine - INFO - [cached since 33.07s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:38:50,053 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:38:50,053 - sqlalchemy.engine.Engine - INFO - [cached since 33.05s ago] ()
2025-08-13 09:38:50,054 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:38:50,056 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:50,056 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:38:50,056 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:50,056 - app.services.chatbot_service - ERROR - Error processing message: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:38:50,056 - app.api.chat - ERROR - Failed to process message: Failed to process message: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:40:56,684 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:40:56,699 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:40:56,701 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:40:56,701 - sqlalchemy.engine.Engine - INFO - [cached since 159.7s ago] ('["fall_compliance_events"',)
2025-08-13 09:40:56,704 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:40:56,704 - sqlalchemy.engine.Engine - INFO - [cached since 159.7s ago] ()
2025-08-13 09:40:56,705 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:40:56,706 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,706 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,707 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:40:56,707 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:40:56,707 - sqlalchemy.engine.Engine - INFO - [cached since 159.7s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:40:56,708 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:40:56,708 - sqlalchemy.engine.Engine - INFO - [cached since 159.7s ago] ()
2025-08-13 09:40:56,709 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:40:56,710 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,711 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,712 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:40:56,712 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:40:56,712 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:40:56,713 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:40:56,714 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:40:56,714 - sqlalchemy.engine.Engine - INFO - [cached since 159.7s ago] ('["fall_compliance_events"',)
2025-08-13 09:40:56,715 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:40:56,715 - sqlalchemy.engine.Engine - INFO - [cached since 159.7s ago] ()
2025-08-13 09:40:56,715 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:40:56,716 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,716 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,719 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:40:56,721 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:40:56,721 - sqlalchemy.engine.Engine - INFO - [cached since 159.7s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:40:56,725 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:40:56,726 - sqlalchemy.engine.Engine - INFO - [cached since 159.7s ago] ()
2025-08-13 09:40:56,726 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:40:56,727 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,728 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,728 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:40:56,728 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:40:56,728 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:40:56,730 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:40:56,730 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:40:56,731 - sqlalchemy.engine.Engine - INFO - [cached since 159.7s ago] ('["fall_compliance_events"',)
2025-08-13 09:40:56,745 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:40:56,745 - sqlalchemy.engine.Engine - INFO - [cached since 159.8s ago] ()
2025-08-13 09:40:56,746 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:40:56,746 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,746 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,746 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:40:56,747 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:40:56,747 - sqlalchemy.engine.Engine - INFO - [cached since 159.8s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:40:56,747 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:40:56,747 - sqlalchemy.engine.Engine - INFO - [cached since 159.7s ago] ()
2025-08-13 09:40:56,748 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:40:56,748 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,748 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,748 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:40:56,748 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:40:56,749 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:40:56,749 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:40:56,749 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:40:56,749 - sqlalchemy.engine.Engine - INFO - [cached since 159.8s ago] ('["fall_compliance_events"',)
2025-08-13 09:40:56,750 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:40:56,750 - sqlalchemy.engine.Engine - INFO - [cached since 159.8s ago] ()
2025-08-13 09:40:56,750 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:40:56,751 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,751 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,751 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:40:56,752 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:40:56,752 - sqlalchemy.engine.Engine - INFO - [cached since 159.8s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:40:56,752 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:40:56,753 - sqlalchemy.engine.Engine - INFO - [cached since 159.8s ago] ()
2025-08-13 09:40:56,753 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:40:56,753 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,753 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:40:56,754 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:40:56,754 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:41:20,328 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:41:20,332 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:41:20,335 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:41:20,336 - sqlalchemy.engine.Engine - INFO - [cached since 183.4s ago] ('["fall_compliance_events"',)
2025-08-13 09:41:20,338 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:41:20,338 - sqlalchemy.engine.Engine - INFO - [cached since 183.3s ago] ()
2025-08-13 09:41:20,341 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:41:20,344 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:41:20,344 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:41:20,345 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:41:20,346 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:41:20,346 - sqlalchemy.engine.Engine - INFO - [cached since 183.4s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:41:20,348 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:41:20,348 - sqlalchemy.engine.Engine - INFO - [cached since 183.3s ago] ()
2025-08-13 09:41:20,350 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:41:20,351 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:41:20,351 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:41:20,351 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:41:20,351 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:41:23,565 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:41:23,566 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:41:23,566 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:41:23,566 - sqlalchemy.engine.Engine - INFO - [cached since 186.6s ago] ('["fall_compliance_events"',)
2025-08-13 09:41:23,567 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:41:23,567 - sqlalchemy.engine.Engine - INFO - [cached since 186.6s ago] ()
2025-08-13 09:41:23,569 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:41:23,569 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:41:23,569 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:41:23,572 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:41:23,573 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:41:23,573 - sqlalchemy.engine.Engine - INFO - [cached since 186.6s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:41:23,589 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:41:23,589 - sqlalchemy.engine.Engine - INFO - [cached since 186.6s ago] ()
2025-08-13 09:41:23,590 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:41:23,591 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:41:23,591 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:41:23,591 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:41:23,591 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:41:24,286 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:41:24,288 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:41:24,289 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:41:24,289 - sqlalchemy.engine.Engine - INFO - [cached since 187.3s ago] ('["fall_compliance_events"',)
2025-08-13 09:41:24,292 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM ["fall_compliance_events"
2025-08-13 09:41:24,292 - sqlalchemy.engine.Engine - INFO - [cached since 187.3s ago] ()
2025-08-13 09:41:24,294 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:41:24,298 - app.services.database_service - ERROR - Error fetching data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:41:24,298 - app.services.database_service - WARNING - Skipping table ["fall_compliance_events": Failed to fetch data from table ["fall_compliance_events": (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "["
[SQL: SELECT COUNT(*) FROM ["fall_compliance_events"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:41:24,302 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:41:24,302 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:41:24,302 - sqlalchemy.engine.Engine - INFO - [cached since 187.3s ago] (' "fall_incidents_primary"]',)
2025-08-13 09:41:24,303 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM  "fall_incidents_primary"]
2025-08-13 09:41:24,303 - sqlalchemy.engine.Engine - INFO - [cached since 187.3s ago] ()
2025-08-13 09:41:24,304 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 09:41:24,305 - app.services.database_service - ERROR - Error fetching data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:41:24,305 - app.services.database_service - WARNING - Skipping table  "fall_incidents_primary"]: Failed to fetch data from table  "fall_incidents_primary"]: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near "]"
[SQL: SELECT COUNT(*) FROM  "fall_incidents_primary"]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 09:41:24,305 - app.services.chatbot_service - ERROR - Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:41:24,305 - app.api.chat - ERROR - Failed to initialize chatbot: Failed to initialize chatbot: No data could be fetched from the database
2025-08-13 09:42:48,905 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:44:40,914 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:44:40,914 - app.main - INFO - Configuration validated successfully
2025-08-13 09:44:52,028 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:44:52,028 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:44:52,108 - app.services.database_service - INFO - Database connection established
2025-08-13 09:44:52,109 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 09:44:52,109 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 09:44:52,135 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 09:44:52,135 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:44:52,136 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 09:44:52,136 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:44:52,137 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 09:44:52,137 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:44:52,138 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:44:52,138 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:44:52,138 - sqlalchemy.engine.Engine - INFO - [generated in 0.00012s] ('fall_compliance_events',)
2025-08-13 09:44:52,148 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 09:44:52,148 - sqlalchemy.engine.Engine - INFO - [generated in 0.00014s] ()
2025-08-13 09:44:52,149 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:44:52,150 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:44:52,150 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:44:52,151 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:44:52,151 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s] ()
2025-08-13 09:44:52,156 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 09:44:52,156 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:44:52,157 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 09:44:52,157 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 09:44:52,157 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:44:52,157 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:44:52,157 - sqlalchemy.engine.Engine - INFO - [cached since 0.01919s ago] ('fall_incidents_primary',)
2025-08-13 09:44:52,160 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 09:44:52,161 - sqlalchemy.engine.Engine - INFO - [generated in 0.00012s] ()
2025-08-13 09:44:52,161 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:44:52,162 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:44:52,162 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:44:52,162 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:44:52,162 - sqlalchemy.engine.Engine - INFO - [generated in 0.00011s] ()
2025-08-13 09:44:52,164 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 09:44:52,164 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:44:52,164 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:44:58,533 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 09:44:58,535 - app.services.chatbot_service - INFO - Chatbot initialized successfully
2025-08-13 09:45:27,541 - app.services.chatbot_service - ERROR - Error processing message: 'Message' object has no attribute 'get'
2025-08-13 09:45:27,543 - app.api.chat - ERROR - Failed to process message: Failed to process message: 'Message' object has no attribute 'get'
2025-08-13 09:46:15,285 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:46:16,160 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:46:16,160 - app.main - INFO - Configuration validated successfully
2025-08-13 09:46:27,024 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:46:27,024 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:46:27,072 - app.services.database_service - INFO - Database connection established
2025-08-13 09:46:27,072 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 09:46:27,072 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 09:46:27,086 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 09:46:27,086 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:46:27,087 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 09:46:27,087 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:46:27,088 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 09:46:27,088 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:46:27,089 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:46:27,089 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:46:27,089 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ('fall_compliance_events',)
2025-08-13 09:46:27,104 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 09:46:27,104 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ()
2025-08-13 09:46:27,105 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:46:27,105 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:46:27,106 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:46:27,106 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:46:27,106 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 09:46:27,110 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 09:46:27,110 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:46:27,110 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 09:46:27,110 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 09:46:27,111 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:46:27,111 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:46:27,111 - sqlalchemy.engine.Engine - INFO - [cached since 0.02167s ago] ('fall_incidents_primary',)
2025-08-13 09:46:27,114 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 09:46:27,114 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 09:46:27,115 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:46:27,116 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:46:27,116 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:46:27,116 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:46:27,116 - sqlalchemy.engine.Engine - INFO - [generated in 0.00012s] ()
2025-08-13 09:46:27,122 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 09:46:27,122 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:46:27,123 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:46:38,338 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 09:46:38,341 - app.services.chatbot_service - INFO - Chatbot initialized successfully
2025-08-13 09:46:57,016 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 09:48:15,811 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:48:16,658 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:48:16,658 - app.main - INFO - Configuration validated successfully
2025-08-13 09:48:21,408 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:48:22,201 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:48:22,201 - app.main - INFO - Configuration validated successfully
2025-08-13 09:48:23,921 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:48:24,979 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:48:24,980 - app.main - INFO - Configuration validated successfully
2025-08-13 09:48:26,998 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:48:29,123 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:48:29,123 - app.main - INFO - Configuration validated successfully
2025-08-13 09:48:29,730 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:48:30,471 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:48:30,472 - app.main - INFO - Configuration validated successfully
2025-08-13 09:48:30,675 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:48:32,704 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:48:32,705 - app.main - INFO - Configuration validated successfully
2025-08-13 09:48:33,109 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:48:37,162 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:48:37,163 - app.main - INFO - Configuration validated successfully
2025-08-13 09:48:37,366 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:48:38,884 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:48:38,884 - app.main - INFO - Configuration validated successfully
2025-08-13 09:48:39,390 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:48:40,505 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:48:40,505 - app.main - INFO - Configuration validated successfully
2025-08-13 09:48:45,645 - app.services.chatbot_service - INFO - Initializing chatbot...
2025-08-13 09:48:45,646 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:48:45,702 - app.services.database_service - INFO - Database connection established
2025-08-13 09:48:45,702 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 09:48:45,702 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 09:48:45,714 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 09:48:45,715 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:48:45,716 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 09:48:45,716 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:48:45,717 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 09:48:45,717 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:48:45,718 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:48:45,718 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:48:45,718 - sqlalchemy.engine.Engine - INFO - [generated in 0.00012s] ('fall_compliance_events',)
2025-08-13 09:48:45,743 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 09:48:45,743 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ()
2025-08-13 09:48:45,744 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:48:45,745 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:48:45,746 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:48:45,746 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:48:45,746 - sqlalchemy.engine.Engine - INFO - [generated in 0.00010s] ()
2025-08-13 09:48:45,749 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 09:48:45,749 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:48:45,750 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 09:48:45,750 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 09:48:45,750 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:48:45,750 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:48:45,750 - sqlalchemy.engine.Engine - INFO - [cached since 0.03208s ago] ('fall_incidents_primary',)
2025-08-13 09:48:45,757 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 09:48:45,757 - sqlalchemy.engine.Engine - INFO - [generated in 0.00010s] ()
2025-08-13 09:48:45,758 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:48:45,758 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:48:45,759 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:48:45,759 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:48:45,759 - sqlalchemy.engine.Engine - INFO - [generated in 0.00011s] ()
2025-08-13 09:48:45,761 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 09:48:45,761 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:48:45,761 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:49:15,847 - app.services.gemini_service - WARNING - Attempt 1 failed: 
2025-08-13 09:49:20,229 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 09:49:20,232 - app.services.chatbot_service - INFO - Chatbot initialized successfully
2025-08-13 09:49:26,822 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 09:51:55,909 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:51:56,760 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 09:51:56,760 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:51:56,792 - app.services.database_service - INFO - Database connection established
2025-08-13 09:51:56,792 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 09:51:56,792 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 09:51:56,793 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:51:56,793 - app.main - INFO - Configuration validated successfully
2025-08-13 09:51:56,802 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 09:51:56,802 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:51:56,804 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 09:51:56,804 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:51:56,805 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 09:51:56,805 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:51:56,805 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:51:56,806 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:51:56,806 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ('fall_compliance_events',)
2025-08-13 09:51:56,820 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 09:51:56,820 - sqlalchemy.engine.Engine - INFO - [generated in 0.00013s] ()
2025-08-13 09:51:56,821 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:51:56,821 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:51:56,822 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:51:56,822 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:51:56,822 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 09:51:56,825 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 09:51:56,825 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:51:56,825 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 09:51:56,825 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 09:51:56,825 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:51:56,826 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:51:56,826 - sqlalchemy.engine.Engine - INFO - [cached since 0.02002s ago] ('fall_incidents_primary',)
2025-08-13 09:51:56,829 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 09:51:56,829 - sqlalchemy.engine.Engine - INFO - [generated in 0.00011s] ()
2025-08-13 09:51:56,830 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:51:56,830 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:51:56,830 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:51:56,831 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:51:56,831 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s] ()
2025-08-13 09:51:56,833 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 09:51:56,833 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:51:56,833 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:51:56,856 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 09:51:56,856 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 09:52:22,073 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:52:22,946 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 09:52:22,946 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:52:22,974 - app.services.database_service - INFO - Database connection established
2025-08-13 09:52:22,975 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 09:52:22,975 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 09:52:22,975 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:52:22,975 - app.main - INFO - Configuration validated successfully
2025-08-13 09:52:22,983 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 09:52:22,983 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:52:22,984 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 09:52:22,984 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:52:22,985 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 09:52:22,985 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:52:22,985 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:22,985 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:52:22,985 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ('fall_compliance_events',)
2025-08-13 09:52:23,004 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 09:52:23,004 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-08-13 09:52:23,005 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:23,006 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:52:23,006 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:23,006 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:52:23,006 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 09:52:23,009 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 09:52:23,009 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:23,009 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 09:52:23,009 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 09:52:23,009 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:23,010 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:52:23,010 - sqlalchemy.engine.Engine - INFO - [cached since 0.02422s ago] ('fall_incidents_primary',)
2025-08-13 09:52:23,014 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 09:52:23,014 - sqlalchemy.engine.Engine - INFO - [generated in 0.00014s] ()
2025-08-13 09:52:23,015 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:23,015 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:52:23,015 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:23,015 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:52:23,015 - sqlalchemy.engine.Engine - INFO - [generated in 0.00011s] ()
2025-08-13 09:52:23,017 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 09:52:23,017 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:23,018 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:52:23,044 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 09:52:23,044 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 09:52:25,123 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:52:25,873 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 09:52:25,873 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:52:25,896 - app.services.database_service - INFO - Database connection established
2025-08-13 09:52:25,896 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 09:52:25,896 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 09:52:25,897 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:52:25,897 - app.main - INFO - Configuration validated successfully
2025-08-13 09:52:25,916 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 09:52:25,916 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:52:25,917 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 09:52:25,917 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:52:25,918 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 09:52:25,918 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:52:25,919 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:25,919 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:52:25,919 - sqlalchemy.engine.Engine - INFO - [generated in 0.00012s] ('fall_compliance_events',)
2025-08-13 09:52:25,928 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 09:52:25,928 - sqlalchemy.engine.Engine - INFO - [generated in 0.00016s] ()
2025-08-13 09:52:25,929 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:25,929 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:52:25,930 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:25,930 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:52:25,930 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 09:52:25,933 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 09:52:25,933 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:25,933 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 09:52:25,933 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 09:52:25,933 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:25,933 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:52:25,934 - sqlalchemy.engine.Engine - INFO - [cached since 0.01448s ago] ('fall_incidents_primary',)
2025-08-13 09:52:25,936 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 09:52:25,936 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 09:52:25,937 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:25,937 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:52:25,938 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:25,938 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:52:25,938 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s] ()
2025-08-13 09:52:25,940 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 09:52:25,940 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:25,940 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:52:25,967 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 09:52:25,967 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 09:52:34,515 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:52:35,212 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 09:52:35,212 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:52:35,235 - app.services.database_service - INFO - Database connection established
2025-08-13 09:52:35,235 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 09:52:35,235 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 09:52:35,236 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:52:35,236 - app.main - INFO - Configuration validated successfully
2025-08-13 09:52:35,243 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 09:52:35,243 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:52:35,244 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 09:52:35,244 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:52:35,245 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 09:52:35,245 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:52:35,245 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:35,246 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:52:35,246 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ('fall_compliance_events',)
2025-08-13 09:52:35,256 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 09:52:35,256 - sqlalchemy.engine.Engine - INFO - [generated in 0.00014s] ()
2025-08-13 09:52:35,257 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:35,257 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:52:35,258 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:35,258 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:52:35,258 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 09:52:35,260 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 09:52:35,260 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:35,261 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 09:52:35,261 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 09:52:35,261 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:35,261 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:52:35,261 - sqlalchemy.engine.Engine - INFO - [cached since 0.01577s ago] ('fall_incidents_primary',)
2025-08-13 09:52:35,266 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 09:52:35,266 - sqlalchemy.engine.Engine - INFO - [generated in 0.00013s] ()
2025-08-13 09:52:35,267 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:35,267 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:52:35,267 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:35,267 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:52:35,267 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 09:52:35,269 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 09:52:35,269 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:35,270 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:52:35,294 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 09:52:35,294 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 09:52:35,295 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 09:52:36,171 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:52:36,907 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 09:52:36,907 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:52:36,930 - app.services.database_service - INFO - Database connection established
2025-08-13 09:52:36,930 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 09:52:36,930 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 09:52:36,931 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:52:36,931 - app.main - INFO - Configuration validated successfully
2025-08-13 09:52:36,937 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 09:52:36,937 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:52:36,938 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 09:52:36,938 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:52:36,939 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 09:52:36,939 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:52:36,940 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:36,940 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:52:36,940 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ('fall_compliance_events',)
2025-08-13 09:52:36,949 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 09:52:36,949 - sqlalchemy.engine.Engine - INFO - [generated in 0.00014s] ()
2025-08-13 09:52:36,950 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:36,950 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:52:36,951 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:36,951 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:52:36,951 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 09:52:36,953 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 09:52:36,953 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:36,954 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 09:52:36,954 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 09:52:36,954 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:36,954 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:52:36,954 - sqlalchemy.engine.Engine - INFO - [cached since 0.01436s ago] ('fall_incidents_primary',)
2025-08-13 09:52:36,957 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 09:52:36,958 - sqlalchemy.engine.Engine - INFO - [generated in 0.00011s] ()
2025-08-13 09:52:36,958 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:36,958 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:52:36,959 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:52:36,959 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:52:36,959 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 09:52:36,961 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 09:52:36,961 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:52:36,961 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:52:36,986 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 09:52:36,986 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 09:52:36,986 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 09:53:12,629 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 09:53:12,629 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:53:12,663 - app.services.database_service - INFO - Database connection established
2025-08-13 09:53:12,663 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 09:53:12,663 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 09:53:12,664 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:53:12,664 - app.main - INFO - Configuration validated successfully
2025-08-13 09:53:12,684 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 09:53:12,684 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:53:12,685 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 09:53:12,685 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:53:12,686 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 09:53:12,686 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:53:12,687 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:53:12,687 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:53:12,687 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s] ('fall_compliance_events',)
2025-08-13 09:53:12,696 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 09:53:12,696 - sqlalchemy.engine.Engine - INFO - [generated in 0.00012s] ()
2025-08-13 09:53:12,697 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:53:12,698 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:53:12,698 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:53:12,698 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:53:12,698 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 09:53:12,701 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 09:53:12,701 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:53:12,701 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 09:53:12,701 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 09:53:12,701 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:53:12,702 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:53:12,702 - sqlalchemy.engine.Engine - INFO - [cached since 0.01449s ago] ('fall_incidents_primary',)
2025-08-13 09:53:12,705 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 09:53:12,705 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 09:53:12,705 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:53:12,706 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:53:12,706 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:53:12,706 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:53:12,706 - sqlalchemy.engine.Engine - INFO - [generated in 0.00013s] ()
2025-08-13 09:53:12,708 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 09:53:12,708 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:53:12,708 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:53:12,732 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 09:53:12,732 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 09:53:12,733 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 09:53:15,113 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 09:53:16,173 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 09:53:16,173 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:53:16,196 - app.services.database_service - INFO - Database connection established
2025-08-13 09:53:16,196 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 09:53:16,196 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 09:53:16,196 - app.main - INFO - Starting up FastAPI application...
2025-08-13 09:53:16,196 - app.main - INFO - Configuration validated successfully
2025-08-13 09:53:16,203 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 09:53:16,203 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:53:16,205 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 09:53:16,205 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:53:16,205 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 09:53:16,205 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 09:53:16,206 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:53:16,206 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:53:16,206 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ('fall_compliance_events',)
2025-08-13 09:53:16,226 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 09:53:16,226 - sqlalchemy.engine.Engine - INFO - [generated in 0.00017s] ()
2025-08-13 09:53:16,227 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:53:16,227 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:53:16,228 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:53:16,228 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 09:53:16,228 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 09:53:16,231 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 09:53:16,231 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:53:16,231 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 09:53:16,231 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 09:53:16,232 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:53:16,232 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 09:53:16,232 - sqlalchemy.engine.Engine - INFO - [cached since 0.02613s ago] ('fall_incidents_primary',)
2025-08-13 09:53:16,236 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 09:53:16,236 - sqlalchemy.engine.Engine - INFO - [generated in 0.00015s] ()
2025-08-13 09:53:16,236 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:53:16,237 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:53:16,237 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 09:53:16,237 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 09:53:16,237 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 09:53:16,261 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 09:53:16,261 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 09:53:16,261 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 09:53:16,264 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 09:53:16,264 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 09:53:16,265 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 09:53:24,347 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 09:53:49,186 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 09:55:54,264 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 09:56:33,520 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 09:57:15,539 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 09:57:31,989 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:02:39,327 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:11:45,234 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:11:46,183 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:11:46,183 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:11:46,215 - app.services.database_service - INFO - Database connection established
2025-08-13 10:11:46,215 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:11:46,215 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:11:46,216 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:11:46,216 - app.main - INFO - Configuration validated successfully
2025-08-13 10:11:46,223 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:11:46,223 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:11:46,224 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:11:46,224 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:11:46,225 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:11:46,225 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:11:46,225 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:11:46,226 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:11:46,226 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ('fall_compliance_events',)
2025-08-13 10:11:46,236 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 10:11:46,236 - sqlalchemy.engine.Engine - INFO - [generated in 0.00012s] ()
2025-08-13 10:11:46,237 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:11:46,238 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:11:46,238 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:11:46,238 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:11:46,238 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:11:46,241 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:11:46,241 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:11:46,241 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:11:46,241 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:11:46,241 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:11:46,242 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:11:46,242 - sqlalchemy.engine.Engine - INFO - [cached since 0.01588s ago] ('fall_incidents_primary',)
2025-08-13 10:11:46,244 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 10:11:46,245 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s] ()
2025-08-13 10:11:46,245 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:11:46,246 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:11:46,246 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:11:46,246 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:11:46,246 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:11:46,248 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:11:46,248 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:11:46,248 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:11:46,349 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:11:46,349 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:11:46,350 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:12:10,254 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:12:11,309 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:12:11,309 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:12:11,340 - app.services.database_service - INFO - Database connection established
2025-08-13 10:12:11,340 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:12:11,340 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:12:11,341 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:12:11,341 - app.main - INFO - Configuration validated successfully
2025-08-13 10:12:11,349 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:12:11,349 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:12:11,350 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:12:11,350 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:12:11,351 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:12:11,351 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:12:11,351 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:12:11,352 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:12:11,352 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ('fall_compliance_events',)
2025-08-13 10:12:11,360 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 10:12:11,360 - sqlalchemy.engine.Engine - INFO - [generated in 0.00012s] ()
2025-08-13 10:12:11,361 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:12:11,361 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:12:11,362 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:12:11,362 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:12:11,362 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:12:11,364 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:12:11,364 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:12:11,365 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:12:11,365 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:12:11,365 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:12:11,365 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:12:11,365 - sqlalchemy.engine.Engine - INFO - [cached since 0.01369s ago] ('fall_incidents_primary',)
2025-08-13 10:12:11,368 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 10:12:11,369 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:12:11,369 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:12:11,369 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:12:11,370 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:12:11,370 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:12:11,370 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:12:11,372 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:12:11,372 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:12:11,372 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:12:11,397 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:12:11,398 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:12:11,398 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:12:39,860 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:12:40,731 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:12:40,731 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:12:40,763 - app.services.database_service - INFO - Database connection established
2025-08-13 10:12:40,763 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:12:40,763 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:12:40,763 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:12:40,764 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:12:40,764 - app.main - INFO - Configuration validated successfully
2025-08-13 10:12:40,786 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:12:40,786 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:12:40,787 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:12:40,787 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:12:40,788 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:12:40,788 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:12:40,788 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:12:40,788 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:12:40,789 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:12:40,792 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:12:40,792 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:12:40,793 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:12:40,793 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:12:40,793 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:12:40,793 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:12:40,793 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:12:40,793 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:12:40,795 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:12:40,795 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:12:40,796 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:12:40,799 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:12:40,799 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:12:40,799 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:13:26,525 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:18:27,990 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:18:27,990 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:18:28,024 - app.services.database_service - INFO - Database connection established
2025-08-13 10:18:28,024 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:18:28,024 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:18:28,024 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:18:28,026 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:18:28,026 - app.main - INFO - Configuration validated successfully
2025-08-13 10:18:28,040 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:18:28,040 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:18:28,041 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:18:28,041 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:18:28,042 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:18:28,042 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:18:28,042 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:18:28,042 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:18:28,042 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:18:28,048 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:18:28,048 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:18:28,048 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:18:28,048 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:18:28,048 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:18:28,049 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:18:28,049 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:18:28,049 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:18:28,052 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:18:28,052 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:18:28,052 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:18:28,055 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:18:28,055 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:18:28,055 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:18:29,850 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:18:30,658 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:18:30,659 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:18:30,681 - app.services.database_service - INFO - Database connection established
2025-08-13 10:18:30,682 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:18:30,682 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:18:30,682 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:18:30,683 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:18:30,683 - app.main - INFO - Configuration validated successfully
2025-08-13 10:18:30,689 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:18:30,689 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:18:30,690 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:18:30,690 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:18:30,691 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:18:30,691 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:18:30,692 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:18:30,692 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:18:30,692 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:18:30,695 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:18:30,695 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:18:30,695 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:18:30,695 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:18:30,695 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:18:30,696 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:18:30,696 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:18:30,696 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:18:30,698 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:18:30,698 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:18:30,698 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:18:30,701 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:18:30,701 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:18:30,702 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:18:37,062 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:18:37,819 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:18:37,819 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:18:37,842 - app.services.database_service - INFO - Database connection established
2025-08-13 10:18:37,842 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:18:37,842 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:18:37,842 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:18:37,843 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:18:37,843 - app.main - INFO - Configuration validated successfully
2025-08-13 10:18:37,861 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:18:37,861 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:18:37,863 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:18:37,863 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:18:37,863 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:18:37,864 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:18:37,864 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:18:37,865 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:18:37,865 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:18:37,868 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:18:37,868 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:18:37,868 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:18:37,868 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:18:37,869 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:18:37,869 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:18:37,869 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:18:37,869 - sqlalchemy.engine.Engine - INFO - [generated in 0.00010s] ()
2025-08-13 10:18:37,871 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:18:37,871 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:18:37,872 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:18:37,875 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:18:37,875 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:18:37,875 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:18:45,824 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:19:08,556 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:19:08,559 - app.services.chatbot_service - INFO - SQL query detected: SELECT
  COUNT(*)
FROM fall_incidents_primary
WHERE
  RNAO_ASSESSMENT = 'Done';
2025-08-13 10:19:08,560 - app.services.database_service - INFO - Executing SQL query: SELECT
  COUNT(*)
FROM fall_incidents_primary
WHERE
  RNAO_ASSESSMENT = 'Done';
2025-08-13 10:19:08,563 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:19:08,563 - sqlalchemy.engine.Engine - INFO - SELECT
  COUNT(*)
FROM fall_incidents_primary
WHERE
  RNAO_ASSESSMENT = 'Done';
2025-08-13 10:19:08,564 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ()
2025-08-13 10:19:08,568 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 10:19:08,569 - app.services.database_service - ERROR - Error executing SQL query: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "rnao_assessment" does not exist
[SQL: SELECT
  COUNT(*)
FROM fall_incidents_primary
WHERE
  RNAO_ASSESSMENT = 'Done';]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 10:21:12,541 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:21:13,404 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:21:13,404 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:21:13,437 - app.services.database_service - INFO - Database connection established
2025-08-13 10:21:13,437 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:21:13,437 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:21:13,437 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:21:13,438 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:21:13,438 - app.main - INFO - Configuration validated successfully
2025-08-13 10:21:13,446 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:21:13,446 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:21:13,447 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:21:13,447 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:21:13,447 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:21:13,447 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:21:13,448 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:21:13,448 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:21:13,448 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:21:13,452 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:21:13,452 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:21:13,452 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:21:13,452 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:21:13,452 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:21:13,453 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:21:13,453 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:21:13,453 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:21:13,455 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:21:13,455 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:21:13,455 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:21:13,458 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:21:13,458 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:21:13,458 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:21:18,298 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:21:19,055 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:21:19,055 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:21:19,078 - app.services.database_service - INFO - Database connection established
2025-08-13 10:21:19,078 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:21:19,078 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:21:19,078 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:21:19,079 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:21:19,079 - app.main - INFO - Configuration validated successfully
2025-08-13 10:21:19,085 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:21:19,085 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:21:19,086 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:21:19,086 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:21:19,087 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:21:19,087 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:21:19,088 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:21:19,088 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:21:19,088 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:21:19,091 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:21:19,091 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:21:19,091 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:21:19,091 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:21:19,091 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:21:19,092 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:21:19,092 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:21:19,092 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s] ()
2025-08-13 10:21:19,094 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:21:19,094 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:21:19,094 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:21:19,097 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:21:19,097 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:21:19,097 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:21:35,854 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:21:36,683 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:21:36,683 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:21:36,714 - app.services.database_service - INFO - Database connection established
2025-08-13 10:21:36,714 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:21:36,715 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:21:36,715 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:21:36,715 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:21:36,716 - app.main - INFO - Configuration validated successfully
2025-08-13 10:21:36,724 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:21:36,724 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:21:36,724 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:21:36,725 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:21:36,725 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:21:36,725 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:21:36,726 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:21:36,726 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:21:36,726 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:21:36,729 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:21:36,729 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:21:36,729 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:21:36,729 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:21:36,729 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:21:36,730 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:21:36,730 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:21:36,730 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:21:36,732 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:21:36,732 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:21:36,732 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:21:36,735 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:21:36,735 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:21:36,735 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:21:37,931 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:21:38,764 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:21:38,764 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:21:38,788 - app.services.database_service - INFO - Database connection established
2025-08-13 10:21:38,788 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:21:38,788 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:21:38,788 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:21:38,789 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:21:38,789 - app.main - INFO - Configuration validated successfully
2025-08-13 10:21:38,795 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:21:38,795 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:21:38,796 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:21:38,796 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:21:38,797 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:21:38,797 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:21:38,797 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:21:38,798 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:21:38,798 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:21:38,800 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:21:38,800 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:21:38,801 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:21:38,801 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:21:38,801 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:21:38,802 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:21:38,802 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:21:38,802 - sqlalchemy.engine.Engine - INFO - [generated in 0.00010s] ()
2025-08-13 10:21:38,804 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:21:38,804 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:21:38,804 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:21:38,807 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:21:38,807 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:21:38,807 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:21:48,914 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:21:48,927 - app.services.chatbot_service - INFO - Fixed SQL query: SELECT
  COUNT(*)
FROM fall_incidents_primary
WHERE
  rnao_assessment = 'Done'; -> "SELECT"
  "COUNT"(*)
"FROM" "fall_incidents_primary"
"WHERE"
  ""RNAO_ASSESSMENT"" = '"Done"';
2025-08-13 10:21:48,927 - app.services.chatbot_service - INFO - SQL query detected: "SELECT"
  "COUNT"(*)
"FROM" "fall_incidents_primary"
"WHERE"
  ""RNAO_ASSESSMENT"" = '"Done"';
2025-08-13 10:21:48,927 - app.services.database_service - INFO - Executing SQL query: "SELECT"
  "COUNT"(*)
"FROM" "fall_incidents_primary"
"WHERE"
  ""RNAO_ASSESSMENT"" = '"Done"';
2025-08-13 10:21:48,929 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:21:48,929 - sqlalchemy.engine.Engine - INFO - "SELECT"
  "COUNT"(*)
"FROM" "fall_incidents_primary"
"WHERE"
  ""RNAO_ASSESSMENT"" = '"Done"';
2025-08-13 10:21:48,929 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-08-13 10:21:48,931 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 10:21:48,932 - app.services.database_service - ERROR - Error executing SQL query: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ""SELECT""
[SQL: "SELECT"
  "COUNT"(*)
"FROM" "fall_incidents_primary"
"WHERE"
  ""RNAO_ASSESSMENT"" = '"Done"';]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 10:21:48,999 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:21:49,816 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:21:49,816 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:21:49,845 - app.services.database_service - INFO - Database connection established
2025-08-13 10:21:49,845 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:21:49,845 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:21:49,845 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:21:49,846 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:21:49,846 - app.main - INFO - Configuration validated successfully
2025-08-13 10:21:49,864 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:21:49,865 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:21:49,866 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:21:49,866 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:21:49,866 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:21:49,866 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:21:49,867 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:21:49,867 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:21:49,867 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:21:49,870 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:21:49,870 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:21:49,870 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:21:49,870 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:21:49,870 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:21:49,871 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:21:49,871 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:21:49,871 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:21:49,873 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:21:49,873 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:21:49,873 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:21:49,876 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:21:49,876 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:21:49,876 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:22:01,289 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:22:02,245 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:22:02,245 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:22:02,275 - app.services.database_service - INFO - Database connection established
2025-08-13 10:22:02,275 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:22:02,275 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:22:02,275 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:22:02,276 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:22:02,276 - app.main - INFO - Configuration validated successfully
2025-08-13 10:22:02,299 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:22:02,299 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:22:02,300 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:22:02,300 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:22:02,301 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:22:02,301 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:22:02,301 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:22:02,302 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:22:02,302 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:22:02,306 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:22:02,306 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:22:02,306 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:22:02,307 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:22:02,307 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:22:02,307 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:22:02,307 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:22:02,307 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s] ()
2025-08-13 10:22:02,309 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:22:02,309 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:22:02,310 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:22:02,313 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:22:02,313 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:22:02,313 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:22:26,232 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:22:28,848 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:22:28,848 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:22:28,878 - app.services.database_service - INFO - Database connection established
2025-08-13 10:22:28,878 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:22:28,878 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:22:28,878 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:22:28,879 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:22:28,879 - app.main - INFO - Configuration validated successfully
2025-08-13 10:22:28,887 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:22:28,887 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:22:28,888 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:22:28,888 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:22:28,889 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:22:28,889 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:22:28,889 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:22:28,890 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:22:28,890 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:22:28,892 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:22:28,893 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:22:28,893 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:22:28,893 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:22:28,893 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:22:28,893 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:22:28,893 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:22:28,893 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:22:28,895 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:22:28,895 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:22:28,896 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:22:28,899 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:22:28,899 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:22:28,899 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:22:40,112 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:22:40,124 - app.services.chatbot_service - INFO - Fixed SQL query: SELECT
  COUNT(*)
FROM fall_incidents_primary
WHERE
  "RNAO_ASSESSMENT" = 'Done'; -> "SELECT"
  "COUNT"(*)
"FROM" "fall_incidents_primary"
"WHERE"
  """RNAO_ASSESSMENT""" = '"Done"';
2025-08-13 10:22:40,125 - app.services.chatbot_service - INFO - SQL query detected: "SELECT"
  "COUNT"(*)
"FROM" "fall_incidents_primary"
"WHERE"
  """RNAO_ASSESSMENT""" = '"Done"';
2025-08-13 10:22:40,125 - app.services.database_service - INFO - Executing SQL query: "SELECT"
  "COUNT"(*)
"FROM" "fall_incidents_primary"
"WHERE"
  """RNAO_ASSESSMENT""" = '"Done"';
2025-08-13 10:22:40,126 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:22:40,127 - sqlalchemy.engine.Engine - INFO - "SELECT"
  "COUNT"(*)
"FROM" "fall_incidents_primary"
"WHERE"
  """RNAO_ASSESSMENT""" = '"Done"';
2025-08-13 10:22:40,127 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ()
2025-08-13 10:22:40,130 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 10:22:40,131 - app.services.database_service - ERROR - Error executing SQL query: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ""SELECT""
[SQL: "SELECT"
  "COUNT"(*)
"FROM" "fall_incidents_primary"
"WHERE"
  """RNAO_ASSESSMENT""" = '"Done"';]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 10:22:56,926 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:22:56,929 - app.services.chatbot_service - INFO - Fixed SQL query: SELECT
  "NAME",
  COUNT("ID") AS TotalFalls
FROM fall_incidents_primary
GROUP BY
  "NAME"
ORDER BY
  TotalFalls DESC
LIMIT 1; -> "SELECT"
  ""NAME"",
  "COUNT"(""ID"") "AS" "TotalFalls"
"FROM" "fall_incidents_primary"
"GROUP" "BY"
  ""NAME""
"ORDER" "BY"
  "TotalFalls" "DESC"
"LIMIT" 1;
2025-08-13 10:22:56,929 - app.services.chatbot_service - INFO - SQL query detected: "SELECT"
  ""NAME"",
  "COUNT"(""ID"") "AS" "TotalFalls"
"FROM" "fall_incidents_primary"
"GROUP" "BY"
  ""NAME""
"ORDER" "BY"
  "TotalFalls" "DESC"
"LIMIT" 1;
2025-08-13 10:22:56,930 - app.services.database_service - INFO - Executing SQL query: "SELECT"
  ""NAME"",
  "COUNT"(""ID"") "AS" "TotalFalls"
"FROM" "fall_incidents_primary"
"GROUP" "BY"
  ""NAME""
"ORDER" "BY"
  "TotalFalls" "DESC"
"LIMIT" 1;
2025-08-13 10:22:56,931 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:22:56,932 - sqlalchemy.engine.Engine - INFO - "SELECT"
  ""NAME"",
  "COUNT"(""ID"") "AS" "TotalFalls"
"FROM" "fall_incidents_primary"
"GROUP" "BY"
  ""NAME""
"ORDER" "BY"
  "TotalFalls" "DESC"
"LIMIT" 1;
2025-08-13 10:22:56,932 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] ()
2025-08-13 10:22:56,933 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 10:22:56,934 - app.services.database_service - ERROR - Error executing SQL query: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ""SELECT""
[SQL: "SELECT"
  ""NAME"",
  "COUNT"(""ID"") "AS" "TotalFalls"
"FROM" "fall_incidents_primary"
"GROUP" "BY"
  ""NAME""
"ORDER" "BY"
  "TotalFalls" "DESC"
"LIMIT" 1;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 10:23:22,813 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:23:22,817 - app.services.chatbot_service - INFO - Fixed SQL query: SELECT
  *
FROM fall_incidents_primary
WHERE
  "NAME" = 'Evelyn Jones'; -> "SELECT"
  *
"FROM" "fall_incidents_primary"
"WHERE"
  ""NAME"" = '"Evelyn" "Jones"';
2025-08-13 10:23:22,818 - app.services.chatbot_service - INFO - SQL query detected: "SELECT"
  *
"FROM" "fall_incidents_primary"
"WHERE"
  ""NAME"" = '"Evelyn" "Jones"';
2025-08-13 10:23:22,818 - app.services.database_service - INFO - Executing SQL query: "SELECT"
  *
"FROM" "fall_incidents_primary"
"WHERE"
  ""NAME"" = '"Evelyn" "Jones"';
2025-08-13 10:23:22,819 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:23:22,820 - sqlalchemy.engine.Engine - INFO - "SELECT"
  *
"FROM" "fall_incidents_primary"
"WHERE"
  ""NAME"" = '"Evelyn" "Jones"';
2025-08-13 10:23:22,821 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] ()
2025-08-13 10:23:22,824 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 10:23:22,824 - app.services.database_service - ERROR - Error executing SQL query: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ""SELECT""
[SQL: "SELECT"
  *
"FROM" "fall_incidents_primary"
"WHERE"
  ""NAME"" = '"Evelyn" "Jones"';]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 10:23:52,598 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:23:53,597 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:23:53,597 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:23:53,628 - app.services.database_service - INFO - Database connection established
2025-08-13 10:23:53,628 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:23:53,628 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:23:53,628 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:23:53,629 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:23:53,629 - app.main - INFO - Configuration validated successfully
2025-08-13 10:23:53,637 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:23:53,637 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:23:53,638 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:23:53,638 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:23:53,639 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:23:53,639 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:23:53,640 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:23:53,640 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:23:53,640 - sqlalchemy.engine.Engine - INFO - [generated in 0.00010s] ()
2025-08-13 10:23:53,643 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:23:53,643 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:23:53,643 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:23:53,643 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:23:53,643 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:23:53,644 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:23:53,644 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:23:53,644 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s] ()
2025-08-13 10:23:53,646 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:23:53,646 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:23:53,646 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:23:53,649 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:23:53,650 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:23:53,650 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:24:04,693 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:24:04,702 - app.services.chatbot_service - INFO - Fixed SQL query: SELECT
  *
FROM fall_incidents_primary
WHERE
  "NAME" = 'Evelyn Jones'; -> "SELECT"
  *
"FROM" "fall_incidents_primary"
"WHERE"
  ""NAME"" = '"Evelyn" "Jones"';
2025-08-13 10:24:04,702 - app.services.chatbot_service - INFO - SQL query detected: "SELECT"
  *
"FROM" "fall_incidents_primary"
"WHERE"
  ""NAME"" = '"Evelyn" "Jones"';
2025-08-13 10:24:04,702 - app.services.database_service - INFO - Executing SQL query: "SELECT"
  *
"FROM" "fall_incidents_primary"
"WHERE"
  ""NAME"" = '"Evelyn" "Jones"';
2025-08-13 10:24:04,703 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:24:04,704 - sqlalchemy.engine.Engine - INFO - "SELECT"
  *
"FROM" "fall_incidents_primary"
"WHERE"
  ""NAME"" = '"Evelyn" "Jones"';
2025-08-13 10:24:04,704 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] ()
2025-08-13 10:24:04,707 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 10:24:04,707 - app.services.database_service - ERROR - Error executing SQL query: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ""SELECT""
[SQL: "SELECT"
  *
"FROM" "fall_incidents_primary"
"WHERE"
  ""NAME"" = '"Evelyn" "Jones"';]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 10:24:10,817 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:24:13,913 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:24:13,914 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:24:13,943 - app.services.database_service - INFO - Database connection established
2025-08-13 10:24:13,944 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:24:13,944 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:24:13,944 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:24:13,944 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:24:13,945 - app.main - INFO - Configuration validated successfully
2025-08-13 10:24:13,952 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:24:13,952 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:24:13,953 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:24:13,953 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:24:13,954 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:24:13,954 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:24:13,954 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:24:13,954 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:24:13,954 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:24:13,957 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:24:13,957 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:24:13,958 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:24:13,958 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:24:13,958 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:24:13,958 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:24:13,958 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:24:13,958 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:24:13,960 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:24:13,960 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:24:13,961 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:24:13,963 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:24:13,964 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:24:13,964 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:24:19,000 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:24:19,849 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:24:19,850 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:24:19,891 - app.services.database_service - INFO - Database connection established
2025-08-13 10:24:19,891 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:24:19,891 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:24:19,891 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:24:19,892 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:24:19,892 - app.main - INFO - Configuration validated successfully
2025-08-13 10:24:19,901 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:24:19,901 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:24:19,903 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:24:19,903 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:24:19,904 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:24:19,904 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:24:19,905 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:24:19,905 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:24:19,905 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:24:19,908 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:24:19,908 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:24:19,908 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:24:19,908 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:24:19,908 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:24:19,909 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:24:19,909 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:24:19,909 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:24:19,912 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:24:19,912 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:24:19,913 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:24:19,916 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:24:19,916 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:24:19,916 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:24:20,199 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:24:23,769 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:24:23,770 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:24:23,872 - app.services.database_service - INFO - Database connection established
2025-08-13 10:24:23,872 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:24:23,872 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:24:23,872 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:24:23,872 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:24:23,873 - app.main - INFO - Configuration validated successfully
2025-08-13 10:24:23,879 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:24:23,879 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:24:23,880 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:24:23,880 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:24:23,881 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:24:23,881 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:24:23,882 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:24:23,882 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:24:23,882 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s] ()
2025-08-13 10:24:23,888 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:24:23,888 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:24:23,888 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:24:23,889 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:24:23,889 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:24:23,889 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:24:23,890 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:24:23,890 - sqlalchemy.engine.Engine - INFO - [generated in 0.00016s] ()
2025-08-13 10:24:23,893 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:24:23,893 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:24:23,894 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:24:23,901 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:24:23,901 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:24:23,901 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:24:29,836 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:24:29,846 - app.services.chatbot_service - INFO - Fixed SQL query: SELECT
  *
FROM fall_incidents_primary
WHERE
  "NAME" = 'Evelyn Jones'; -> "SELECT"
  *
"FROM" "fall_incidents_primary"
"WHERE"
  ""NAME"" = '"Evelyn" "Jones"';
2025-08-13 10:24:29,846 - app.services.chatbot_service - INFO - SQL query detected: "SELECT"
  *
"FROM" "fall_incidents_primary"
"WHERE"
  ""NAME"" = '"Evelyn" "Jones"';
2025-08-13 10:24:29,846 - app.services.database_service - INFO - Executing SQL query: "SELECT"
  *
"FROM" "fall_incidents_primary"
"WHERE"
  ""NAME"" = '"Evelyn" "Jones"';
2025-08-13 10:24:29,848 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:24:29,849 - sqlalchemy.engine.Engine - INFO - "SELECT"
  *
"FROM" "fall_incidents_primary"
"WHERE"
  ""NAME"" = '"Evelyn" "Jones"';
2025-08-13 10:24:29,849 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] ()
2025-08-13 10:24:29,852 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 10:24:29,853 - app.services.database_service - ERROR - Error executing SQL query: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.PostgresSyntaxError'>: syntax error at or near ""SELECT""
[SQL: "SELECT"
  *
"FROM" "fall_incidents_primary"
"WHERE"
  ""NAME"" = '"Evelyn" "Jones"';]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 10:25:46,282 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:25:47,160 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:25:47,160 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:25:47,192 - app.services.database_service - INFO - Database connection established
2025-08-13 10:25:47,192 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:25:47,192 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:25:47,192 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:25:47,193 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:25:47,193 - app.main - INFO - Configuration validated successfully
2025-08-13 10:25:47,204 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:25:47,204 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:25:47,205 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:25:47,205 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:25:47,206 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:25:47,206 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:25:47,206 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:25:47,207 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:25:47,207 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:25:47,209 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:25:47,209 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:25:47,210 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:25:47,210 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:25:47,210 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:25:47,210 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:25:47,210 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:25:47,210 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:25:47,212 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:25:47,212 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:25:47,213 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:25:47,216 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:25:47,216 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:25:47,216 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:25:56,410 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:25:56,411 - app.services.chatbot_service - INFO - SQL query detected: SELECT
  *
FROM fall_incidents_primary
WHERE
  "NAME" = 'Evelyn Jones';
2025-08-13 10:25:56,411 - app.services.database_service - INFO - Executing SQL query: SELECT
  *
FROM fall_incidents_primary
WHERE
  "NAME" = 'Evelyn Jones';
2025-08-13 10:25:56,412 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:25:56,413 - sqlalchemy.engine.Engine - INFO - SELECT
  *
FROM fall_incidents_primary
WHERE
  "NAME" = 'Evelyn Jones';
2025-08-13 10:25:56,413 - sqlalchemy.engine.Engine - INFO - [generated in 0.00011s] ()
2025-08-13 10:25:56,414 - app.services.database_service - INFO - Query executed successfully. Returned 6 rows
2025-08-13 10:25:56,414 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:26:11,672 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:26:11,674 - app.services.chatbot_service - INFO - SQL query detected: SELECT
  *
FROM fall_incidents_primary
WHERE
  "NAME" = 'Evelyn Jones';
2025-08-13 10:26:11,674 - app.services.database_service - INFO - Executing SQL query: SELECT
  *
FROM fall_incidents_primary
WHERE
  "NAME" = 'Evelyn Jones';
2025-08-13 10:26:11,675 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:26:11,676 - sqlalchemy.engine.Engine - INFO - SELECT
  *
FROM fall_incidents_primary
WHERE
  "NAME" = 'Evelyn Jones';
2025-08-13 10:26:11,676 - sqlalchemy.engine.Engine - INFO - [cached since 15.26s ago] ()
2025-08-13 10:26:11,677 - app.services.database_service - INFO - Query executed successfully. Returned 6 rows
2025-08-13 10:26:11,677 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:26:21,498 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:26:21,502 - app.services.chatbot_service - INFO - SQL query detected: SELECT
  "NAME",
  COUNT("ID") AS TotalFalls
FROM fall_incidents_primary
GROUP BY
  "NAME"
ORDER BY
  TotalFalls DESC
LIMIT 1;
2025-08-13 10:26:21,502 - app.services.database_service - INFO - Executing SQL query: SELECT
  "NAME",
  COUNT("ID") AS TotalFalls
FROM fall_incidents_primary
GROUP BY
  "NAME"
ORDER BY
  TotalFalls DESC
LIMIT 1;
2025-08-13 10:26:21,504 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:26:21,504 - sqlalchemy.engine.Engine - INFO - SELECT
  "NAME",
  COUNT("ID") AS TotalFalls
FROM fall_incidents_primary
GROUP BY
  "NAME"
ORDER BY
  TotalFalls DESC
LIMIT 1;
2025-08-13 10:26:21,505 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] ()
2025-08-13 10:26:21,507 - app.services.database_service - INFO - Query executed successfully. Returned 1 rows
2025-08-13 10:26:21,507 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:27:12,972 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:27:13,820 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:27:13,820 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:27:13,853 - app.services.database_service - INFO - Database connection established
2025-08-13 10:27:13,853 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:27:13,853 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:27:13,853 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:27:13,854 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:27:13,854 - app.main - INFO - Configuration validated successfully
2025-08-13 10:27:13,866 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:27:13,866 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:27:13,867 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:27:13,867 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:27:13,867 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:27:13,867 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:27:13,868 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:27:13,868 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:27:13,868 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:27:13,872 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:27:13,872 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:27:13,872 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:27:13,873 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:27:13,873 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:27:13,873 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:27:13,873 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:27:13,873 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:27:13,875 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:27:13,876 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:27:13,876 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:27:13,879 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:27:13,879 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:27:13,879 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:27:21,738 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:27:22,713 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:27:22,713 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:27:22,743 - app.services.database_service - INFO - Database connection established
2025-08-13 10:27:22,743 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:27:22,743 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:27:22,743 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:27:22,744 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:27:22,744 - app.main - INFO - Configuration validated successfully
2025-08-13 10:27:22,765 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:27:22,765 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:27:22,766 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:27:22,766 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:27:22,766 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:27:22,767 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:27:22,767 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:27:22,768 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:27:22,768 - sqlalchemy.engine.Engine - INFO - [generated in 0.00010s] ()
2025-08-13 10:27:22,770 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:27:22,771 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:27:22,771 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:27:22,771 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:27:22,771 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:27:22,771 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:27:22,772 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:27:22,772 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:27:22,773 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:27:22,773 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:27:22,774 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:27:22,777 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:27:22,777 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:27:22,777 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:27:26,082 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:27:26,835 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:27:26,835 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:27:26,858 - app.services.database_service - INFO - Database connection established
2025-08-13 10:27:26,858 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:27:26,858 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:27:26,858 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:27:26,859 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:27:26,859 - app.main - INFO - Configuration validated successfully
2025-08-13 10:27:26,865 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:27:26,865 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:27:26,866 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:27:26,866 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:27:26,867 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:27:26,867 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:27:26,867 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:27:26,867 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:27:26,868 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:27:26,870 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:27:26,870 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:27:26,871 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:27:26,871 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:27:26,871 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:27:26,871 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:27:26,871 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:27:26,871 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:27:26,873 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:27:26,873 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:27:26,874 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:27:26,876 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:27:26,876 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:27:26,877 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:27:32,344 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:27:47,493 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:27:47,494 - app.services.chatbot_service - INFO - SQL query detected: SELECT
  "NAME",
  COUNT("ID") AS TotalFalls
FROM fall_incidents_primary
GROUP BY
  "NAME"
HAVING
  COUNT("ID") = 4;
2025-08-13 10:27:47,495 - app.services.database_service - INFO - Executing SQL query: SELECT
  "NAME",
  COUNT("ID") AS TotalFalls
FROM fall_incidents_primary
GROUP BY
  "NAME"
HAVING
  COUNT("ID") = 4;
2025-08-13 10:27:47,496 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:27:47,496 - sqlalchemy.engine.Engine - INFO - SELECT
  "NAME",
  COUNT("ID") AS TotalFalls
FROM fall_incidents_primary
GROUP BY
  "NAME"
HAVING
  COUNT("ID") = 4;
2025-08-13 10:27:47,496 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ()
2025-08-13 10:27:47,498 - app.services.database_service - INFO - Query executed successfully. Returned 4 rows
2025-08-13 10:27:47,498 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:28:02,544 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:28:03,465 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:28:03,465 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:28:03,496 - app.services.database_service - INFO - Database connection established
2025-08-13 10:28:03,496 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:28:03,496 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:28:03,496 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:28:03,497 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:28:03,497 - app.main - INFO - Configuration validated successfully
2025-08-13 10:28:03,517 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:28:03,517 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:28:03,518 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:28:03,518 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:28:03,519 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:28:03,519 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:28:03,519 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:28:03,520 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:28:03,520 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:28:03,522 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:28:03,522 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:28:03,523 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:28:03,523 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:28:03,523 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:28:03,524 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:28:03,524 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:28:03,524 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:28:03,526 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:28:03,526 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:28:03,526 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:28:03,529 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:28:03,529 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:28:03,529 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:28:09,257 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:28:10,019 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:28:10,020 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:28:10,042 - app.services.database_service - INFO - Database connection established
2025-08-13 10:28:10,042 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:28:10,042 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:28:10,042 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:28:10,043 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:28:10,043 - app.main - INFO - Configuration validated successfully
2025-08-13 10:28:10,050 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:28:10,050 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:28:10,051 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:28:10,051 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:28:10,052 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:28:10,052 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:28:10,053 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:28:10,053 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:28:10,054 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:28:10,056 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:28:10,056 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:28:10,057 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:28:10,057 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:28:10,057 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:28:10,057 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:28:10,057 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:28:10,057 - sqlalchemy.engine.Engine - INFO - [generated in 0.00010s] ()
2025-08-13 10:28:10,060 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:28:10,060 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:28:10,061 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:28:10,063 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:28:10,064 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:28:10,064 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:28:10,754 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:28:11,869 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:28:11,869 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:28:11,891 - app.services.database_service - INFO - Database connection established
2025-08-13 10:28:11,891 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:28:11,891 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:28:11,891 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:28:11,892 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:28:11,892 - app.main - INFO - Configuration validated successfully
2025-08-13 10:28:11,900 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:28:11,900 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:28:11,900 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:28:11,901 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:28:11,901 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:28:11,901 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:28:11,902 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:28:11,902 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:28:11,902 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:28:11,904 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:28:11,905 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:28:11,905 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:28:11,905 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:28:11,905 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:28:11,906 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:28:11,906 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:28:11,906 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:28:11,908 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:28:11,908 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:28:11,908 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:28:11,911 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:28:11,911 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:28:11,911 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:28:19,059 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:28:58,894 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:28:58,897 - app.services.chatbot_service - INFO - SQL query detected: SELECT
  "DATE",
  "TIME",
  "NAME"
FROM fall_incidents_primary
ORDER BY
  "DATE" DESC,
  "TIME" DESC
LIMIT 1;
2025-08-13 10:28:58,897 - app.services.database_service - INFO - Executing SQL query: SELECT
  "DATE",
  "TIME",
  "NAME"
FROM fall_incidents_primary
ORDER BY
  "DATE" DESC,
  "TIME" DESC
LIMIT 1;
2025-08-13 10:28:58,899 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:28:58,900 - sqlalchemy.engine.Engine - INFO - SELECT
  "DATE",
  "TIME",
  "NAME"
FROM fall_incidents_primary
ORDER BY
  "DATE" DESC,
  "TIME" DESC
LIMIT 1;
2025-08-13 10:28:58,902 - sqlalchemy.engine.Engine - INFO - [generated in 0.00159s] ()
2025-08-13 10:28:58,905 - app.services.database_service - INFO - Query executed successfully. Returned 1 rows
2025-08-13 10:28:58,905 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:29:27,587 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:29:28,420 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:29:28,421 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:29:28,454 - app.services.database_service - INFO - Database connection established
2025-08-13 10:29:28,454 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:29:28,454 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:29:28,454 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:29:28,456 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:29:28,456 - app.main - INFO - Configuration validated successfully
2025-08-13 10:29:28,464 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:29:28,464 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:29:28,465 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:29:28,465 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:29:28,466 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:29:28,466 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:29:28,467 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:29:28,467 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:29:28,467 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:29:28,470 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:29:28,470 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:29:28,470 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:29:28,471 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:29:28,471 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:29:28,471 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:29:28,471 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:29:28,471 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s] ()
2025-08-13 10:29:28,473 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:29:28,473 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:29:28,474 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:29:28,477 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:29:28,477 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:29:28,477 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:29:39,785 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:29:40,668 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:29:40,669 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:29:40,699 - app.services.database_service - INFO - Database connection established
2025-08-13 10:29:40,700 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:29:40,700 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:29:40,700 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:29:40,700 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:29:40,701 - app.main - INFO - Configuration validated successfully
2025-08-13 10:29:40,712 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:29:40,712 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:29:40,713 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:29:40,713 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:29:40,714 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:29:40,714 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:29:40,715 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:29:40,715 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:29:40,715 - sqlalchemy.engine.Engine - INFO - [generated in 0.00013s] ()
2025-08-13 10:29:40,718 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:29:40,718 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:29:40,719 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:29:40,719 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:29:40,719 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:29:40,719 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:29:40,720 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:29:40,720 - sqlalchemy.engine.Engine - INFO - [generated in 0.00010s] ()
2025-08-13 10:29:40,723 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:29:40,723 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:29:40,723 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:29:40,727 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:29:40,727 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:29:40,727 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:29:46,972 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:29:48,130 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:29:48,130 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:29:48,162 - app.services.database_service - INFO - Database connection established
2025-08-13 10:29:48,162 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:29:48,162 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:29:48,162 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:29:48,163 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:29:48,163 - app.main - INFO - Configuration validated successfully
2025-08-13 10:29:48,172 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:29:48,172 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:29:48,172 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:29:48,173 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:29:48,173 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:29:48,173 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:29:48,174 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:29:48,174 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:29:48,174 - sqlalchemy.engine.Engine - INFO - [generated in 0.00011s] ()
2025-08-13 10:29:48,177 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:29:48,177 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:29:48,177 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:29:48,177 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:29:48,177 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:29:48,178 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:29:48,178 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:29:48,178 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:29:48,180 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:29:48,180 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:29:48,180 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:29:48,183 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:29:48,183 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:29:48,183 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:29:55,932 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:29:55,936 - app.services.chatbot_service - INFO - SQL query detected: SELECT
  "DATE",
  "TIME",
  "NAME"
FROM fall_incidents_primary
ORDER BY
  "DATE" DESC,
  "TIME" DESC
LIMIT 1;
2025-08-13 10:29:55,936 - app.services.database_service - INFO - Executing SQL query: SELECT
  "DATE",
  "TIME",
  "NAME"
FROM fall_incidents_primary
ORDER BY
  "DATE" DESC,
  "TIME" DESC
LIMIT 1;
2025-08-13 10:29:55,937 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:29:55,938 - sqlalchemy.engine.Engine - INFO - SELECT
  "DATE",
  "TIME",
  "NAME"
FROM fall_incidents_primary
ORDER BY
  "DATE" DESC,
  "TIME" DESC
LIMIT 1;
2025-08-13 10:29:55,938 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] ()
2025-08-13 10:29:55,941 - app.services.database_service - INFO - Query executed successfully. Returned 1 rows
2025-08-13 10:29:55,942 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:32:09,157 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:32:31,440 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:32:31,442 - app.services.chatbot_service - INFO - SQL query detected: SELECT
    TO_CHAR(DATE, 'YYYY-MM') AS fall_month,
    COUNT(ID) AS number_of_falls
FROM
    fall_incidents_primary
GROUP BY
    fall_month
ORDER BY
    fall_month;
2025-08-13 10:32:31,443 - app.services.database_service - INFO - Executing SQL query: SELECT
    TO_CHAR(DATE, 'YYYY-MM') AS fall_month,
    COUNT(ID) AS number_of_falls
FROM
    fall_incidents_primary
GROUP BY
    fall_month
ORDER BY
    fall_month;
2025-08-13 10:32:31,447 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:32:31,449 - sqlalchemy.engine.Engine - INFO - SELECT
    TO_CHAR(DATE, 'YYYY-MM') AS fall_month,
    COUNT(ID) AS number_of_falls
FROM
    fall_incidents_primary
GROUP BY
    fall_month
ORDER BY
    fall_month;
2025-08-13 10:32:31,449 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] ()
2025-08-13 10:32:31,453 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 10:32:31,454 - app.services.database_service - ERROR - Error executing SQL query: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "date" does not exist
[SQL: SELECT
    TO_CHAR(DATE, 'YYYY-MM') AS fall_month,
    COUNT(ID) AS number_of_falls
FROM
    fall_incidents_primary
GROUP BY
    fall_month
ORDER BY
    fall_month;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 10:33:53,620 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:33:54,499 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:33:54,499 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:33:54,529 - app.services.database_service - INFO - Database connection established
2025-08-13 10:33:54,529 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:33:54,529 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:33:54,529 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:33:54,530 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:33:54,530 - app.main - INFO - Configuration validated successfully
2025-08-13 10:33:54,539 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:33:54,539 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:33:54,540 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:33:54,540 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:33:54,541 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:33:54,541 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:33:54,541 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:33:54,542 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:33:54,542 - sqlalchemy.engine.Engine - INFO - [generated in 0.00012s] ()
2025-08-13 10:33:54,547 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:33:54,547 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:33:54,547 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:33:54,547 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:33:54,547 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:33:54,548 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:33:54,548 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:33:54,548 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:33:54,552 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:33:54,552 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:33:54,552 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:33:54,555 - app.services.gemini_service - INFO - System prompt updated with database data
2025-08-13 10:33:54,555 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:33:54,555 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:34:19,276 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:34:20,220 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:34:20,220 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:34:20,248 - app.services.database_service - INFO - Database connection established
2025-08-13 10:34:20,248 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:34:20,248 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:34:20,248 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:34:20,249 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:34:20,249 - app.main - INFO - Configuration validated successfully
2025-08-13 10:34:20,260 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:34:20,260 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:34:20,261 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:34:20,261 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:34:20,261 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:34:20,261 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:34:20,262 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:34:20,262 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:34:20,262 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:34:20,265 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:34:20,266 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:34:20,266 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:34:20,266 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:34:20,266 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:34:20,266 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:34:20,266 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:34:20,266 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:34:20,268 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:34:20,268 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:34:20,268 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:34:20,271 - app.services.gemini_service - INFO - System prompt updated with database data and schema
2025-08-13 10:34:20,271 - app.services.chatbot_service - INFO - Data initialization completed
2025-08-13 10:34:20,271 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:34:31,161 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:34:31,982 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:34:31,983 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:34:32,013 - app.services.database_service - INFO - Database connection established
2025-08-13 10:34:32,013 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:34:32,013 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:34:32,013 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:34:32,014 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:34:32,014 - app.main - INFO - Configuration validated successfully
2025-08-13 10:34:32,024 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:34:32,024 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:34:32,025 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:34:32,025 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:34:32,026 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:34:32,026 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:34:32,026 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:34:32,027 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:34:32,027 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:34:32,030 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:34:32,030 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:34:32,030 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:34:32,030 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:34:32,030 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:34:32,031 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:34:32,031 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:34:32,031 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:34:32,033 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:34:32,033 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:34:32,033 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:34:32,036 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:34:32,037 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:34:32,037 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ('fall_compliance_events',)
2025-08-13 10:34:32,074 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 10:34:32,074 - sqlalchemy.engine.Engine - INFO - [generated in 0.00017s] ()
2025-08-13 10:34:32,075 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:34:32,076 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:34:32,076 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:34:32,076 - sqlalchemy.engine.Engine - INFO - [cached since 0.03935s ago] ('fall_incidents_primary',)
2025-08-13 10:34:32,091 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 10:34:32,091 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ()
2025-08-13 10:34:32,092 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:34:32,093 - app.services.gemini_service - INFO - System prompt updated with database data and schema
2025-08-13 10:34:32,093 - app.services.chatbot_service - INFO - Data and schema initialization completed
2025-08-13 10:34:32,093 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:34:41,205 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:34:42,302 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:34:42,302 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:34:42,325 - app.services.database_service - INFO - Database connection established
2025-08-13 10:34:42,325 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:34:42,325 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:34:42,325 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:34:42,326 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:34:42,326 - app.main - INFO - Configuration validated successfully
2025-08-13 10:34:42,333 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:34:42,333 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:34:42,334 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:34:42,334 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:34:42,335 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:34:42,335 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:34:42,335 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:34:42,336 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:34:42,336 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:34:42,339 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:34:42,339 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:34:42,339 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:34:42,339 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:34:42,339 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:34:42,340 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:34:42,340 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:34:42,340 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:34:42,343 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:34:42,343 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:34:42,343 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:34:42,346 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:34:42,346 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:34:42,346 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ('fall_compliance_events',)
2025-08-13 10:34:42,379 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 10:34:42,379 - sqlalchemy.engine.Engine - INFO - [generated in 0.00017s] ()
2025-08-13 10:34:42,380 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:34:42,381 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:34:42,381 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:34:42,381 - sqlalchemy.engine.Engine - INFO - [cached since 0.03476s ago] ('fall_incidents_primary',)
2025-08-13 10:34:42,387 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 10:34:42,387 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:34:42,387 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:34:42,388 - app.services.gemini_service - INFO - System prompt updated with database data and schema
2025-08-13 10:34:42,388 - app.services.chatbot_service - INFO - Data and schema initialization completed
2025-08-13 10:34:42,388 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:34:52,738 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:34:53,586 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:34:53,586 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:34:53,614 - app.services.database_service - INFO - Database connection established
2025-08-13 10:34:53,614 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:34:53,614 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:34:53,614 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:34:53,615 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:34:53,615 - app.main - INFO - Configuration validated successfully
2025-08-13 10:34:53,636 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:34:53,636 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:34:53,637 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:34:53,637 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:34:53,638 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:34:53,638 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:34:53,639 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:34:53,639 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:34:53,639 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:34:53,643 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:34:53,643 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:34:53,643 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:34:53,643 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:34:53,643 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:34:53,644 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:34:53,644 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:34:53,644 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:34:53,646 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:34:53,646 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:34:53,646 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:34:53,651 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:34:53,651 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:34:53,651 - sqlalchemy.engine.Engine - INFO - [generated in 0.00011s] ('fall_compliance_events',)
2025-08-13 10:34:53,691 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 10:34:53,691 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ()
2025-08-13 10:34:53,692 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:34:53,693 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:34:53,693 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:34:53,693 - sqlalchemy.engine.Engine - INFO - [cached since 0.04186s ago] ('fall_incidents_primary',)
2025-08-13 10:34:53,699 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 10:34:53,699 - sqlalchemy.engine.Engine - INFO - [generated in 0.00010s] ()
2025-08-13 10:34:53,699 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:34:53,700 - app.services.gemini_service - INFO - System prompt updated with database data and schema
2025-08-13 10:34:53,700 - app.services.chatbot_service - INFO - Data and schema initialization completed
2025-08-13 10:34:53,700 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:34:58,970 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:34:59,985 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:34:59,985 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:35:00,017 - app.services.database_service - INFO - Database connection established
2025-08-13 10:35:00,017 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:35:00,017 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:35:00,017 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:35:00,018 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:35:00,018 - app.main - INFO - Configuration validated successfully
2025-08-13 10:35:00,024 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:35:00,025 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:35:00,025 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:35:00,025 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:35:00,026 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:35:00,026 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:35:00,026 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:35:00,027 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:35:00,027 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:35:00,029 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:35:00,029 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:35:00,029 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:35:00,030 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:35:00,030 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:35:00,030 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:35:00,030 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:35:00,030 - sqlalchemy.engine.Engine - INFO - [generated in 0.00011s] ()
2025-08-13 10:35:00,032 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:35:00,032 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:35:00,032 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:35:00,036 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:35:00,036 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:35:00,036 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ('fall_compliance_events',)
2025-08-13 10:35:00,067 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 10:35:00,067 - sqlalchemy.engine.Engine - INFO - [generated in 0.00016s] ()
2025-08-13 10:35:00,067 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:35:00,068 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:35:00,068 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:35:00,068 - sqlalchemy.engine.Engine - INFO - [cached since 0.03249s ago] ('fall_incidents_primary',)
2025-08-13 10:35:00,072 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 10:35:00,072 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:35:00,073 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:35:00,073 - app.services.gemini_service - INFO - System prompt updated with database data and schema
2025-08-13 10:35:00,073 - app.services.chatbot_service - INFO - Data and schema initialization completed
2025-08-13 10:35:00,073 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:35:20,327 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:35:21,146 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:35:21,146 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:35:21,177 - app.services.database_service - INFO - Database connection established
2025-08-13 10:35:21,177 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:35:21,177 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:35:21,177 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:35:21,177 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:35:21,178 - app.main - INFO - Configuration validated successfully
2025-08-13 10:35:21,186 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:35:21,186 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:35:21,188 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:35:21,188 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:35:21,188 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:35:21,188 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:35:21,189 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:35:21,189 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:35:21,189 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:35:21,193 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:35:21,193 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:35:21,193 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:35:21,193 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:35:21,193 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:35:21,194 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:35:21,194 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:35:21,194 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:35:21,196 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:35:21,196 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:35:21,196 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:35:21,199 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:35:21,200 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:35:21,200 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ('fall_compliance_events',)
2025-08-13 10:35:21,237 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 10:35:21,237 - sqlalchemy.engine.Engine - INFO - [generated in 0.00012s] ()
2025-08-13 10:35:21,238 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:35:21,239 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:35:21,239 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:35:21,239 - sqlalchemy.engine.Engine - INFO - [cached since 0.03903s ago] ('fall_incidents_primary',)
2025-08-13 10:35:21,243 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 10:35:21,243 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:35:21,243 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:35:21,244 - app.services.gemini_service - INFO - System prompt updated with database data and schema
2025-08-13 10:35:21,244 - app.services.chatbot_service - INFO - Data and schema initialization completed
2025-08-13 10:35:21,244 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:35:30,373 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:35:31,155 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:35:31,155 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:35:31,182 - app.services.database_service - INFO - Database connection established
2025-08-13 10:35:31,182 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:35:31,182 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:35:31,182 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:35:31,183 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:35:31,183 - app.main - INFO - Configuration validated successfully
2025-08-13 10:35:31,204 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:35:31,204 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:35:31,205 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:35:31,205 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:35:31,206 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:35:31,206 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:35:31,207 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:35:31,207 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:35:31,207 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:35:31,210 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:35:31,210 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:35:31,210 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:35:31,210 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:35:31,210 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:35:31,211 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:35:31,211 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:35:31,211 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:35:31,213 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:35:31,213 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:35:31,213 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:35:31,217 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:35:31,217 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:35:31,217 - sqlalchemy.engine.Engine - INFO - [generated in 0.00014s] ('fall_compliance_events',)
2025-08-13 10:35:31,247 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 10:35:31,247 - sqlalchemy.engine.Engine - INFO - [generated in 0.00015s] ()
2025-08-13 10:35:31,247 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:35:31,248 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:35:31,248 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:35:31,248 - sqlalchemy.engine.Engine - INFO - [cached since 0.03151s ago] ('fall_incidents_primary',)
2025-08-13 10:35:31,252 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 10:35:31,252 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:35:31,253 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:35:31,253 - app.services.gemini_service - INFO - System prompt updated with database data and schema
2025-08-13 10:35:31,253 - app.services.chatbot_service - INFO - Data and schema initialization completed
2025-08-13 10:35:31,253 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:37:17,012 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:37:17,912 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:37:17,912 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:37:17,945 - app.services.database_service - INFO - Database connection established
2025-08-13 10:37:17,945 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:37:17,945 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:37:17,945 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:37:17,946 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:37:17,946 - app.main - INFO - Configuration validated successfully
2025-08-13 10:37:17,957 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:37:17,957 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:37:17,958 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:37:17,958 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:37:17,959 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:37:17,959 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:37:17,960 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:37:17,960 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:37:17,960 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:37:17,964 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:37:17,964 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:37:17,964 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:37:17,964 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:37:17,964 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:37:17,965 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:37:17,965 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:37:17,965 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:37:17,967 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:37:17,967 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:37:17,967 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:37:17,971 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:37:17,971 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:37:17,971 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s] ('fall_compliance_events',)
2025-08-13 10:37:18,000 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 10:37:18,000 - sqlalchemy.engine.Engine - INFO - [generated in 0.00017s] ()
2025-08-13 10:37:18,012 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:37:18,013 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:37:18,013 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:37:18,013 - sqlalchemy.engine.Engine - INFO - [cached since 0.04244s ago] ('fall_incidents_primary',)
2025-08-13 10:37:18,018 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 10:37:18,018 - sqlalchemy.engine.Engine - INFO - [generated in 0.00013s] ()
2025-08-13 10:37:18,019 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:37:18,019 - app.services.gemini_service - INFO - System prompt updated with database data and schema
2025-08-13 10:37:18,019 - app.services.chatbot_service - INFO - Data and schema initialization completed
2025-08-13 10:37:18,019 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:37:44,715 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:37:45,476 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:37:45,476 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:37:45,503 - app.services.database_service - INFO - Database connection established
2025-08-13 10:37:45,503 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:37:45,503 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:37:45,503 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:37:45,504 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:37:45,504 - app.main - INFO - Configuration validated successfully
2025-08-13 10:37:45,511 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:37:45,511 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:37:45,512 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:37:45,512 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:37:45,512 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:37:45,512 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:37:45,513 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:37:45,513 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:37:45,513 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:37:45,517 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:37:45,518 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:37:45,518 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:37:45,518 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:37:45,518 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:37:45,519 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:37:45,519 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:37:45,519 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ()
2025-08-13 10:37:45,522 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:37:45,522 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:37:45,522 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:37:45,525 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:37:45,525 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:37:45,525 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ('fall_compliance_events',)
2025-08-13 10:37:45,561 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 10:37:45,561 - sqlalchemy.engine.Engine - INFO - [generated in 0.00013s] ()
2025-08-13 10:37:45,562 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:37:45,562 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:37:45,563 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:37:45,563 - sqlalchemy.engine.Engine - INFO - [cached since 0.03746s ago] ('fall_incidents_primary',)
2025-08-13 10:37:45,568 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 10:37:45,568 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s] ()
2025-08-13 10:37:45,568 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:37:45,569 - app.services.gemini_service - INFO - System prompt updated with database data and schema
2025-08-13 10:37:45,569 - app.services.chatbot_service - INFO - Data and schema initialization completed
2025-08-13 10:37:45,569 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:38:03,595 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:38:04,508 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:38:04,508 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:38:04,539 - app.services.database_service - INFO - Database connection established
2025-08-13 10:38:04,539 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:38:04,539 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:38:04,539 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:38:04,540 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:38:04,540 - app.main - INFO - Configuration validated successfully
2025-08-13 10:38:04,547 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:38:04,547 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:38:04,548 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:38:04,548 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:38:04,549 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:38:04,549 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:38:04,549 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:38:04,550 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:38:04,550 - sqlalchemy.engine.Engine - INFO - [generated in 0.00008s] ()
2025-08-13 10:38:04,552 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:38:04,553 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:38:04,553 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:38:04,553 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:38:04,553 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:38:04,553 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:38:04,554 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:38:04,554 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:38:04,555 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:38:04,555 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:38:04,556 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:38:04,559 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:38:04,559 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:38:04,559 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ('fall_compliance_events',)
2025-08-13 10:38:04,590 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 10:38:04,590 - sqlalchemy.engine.Engine - INFO - [generated in 0.00014s] ()
2025-08-13 10:38:04,591 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:38:04,592 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:38:04,592 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:38:04,592 - sqlalchemy.engine.Engine - INFO - [cached since 0.0327s ago] ('fall_incidents_primary',)
2025-08-13 10:38:04,595 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 10:38:04,595 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s] ()
2025-08-13 10:38:04,595 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:38:04,596 - app.services.gemini_service - INFO - System prompt updated with database data and schema
2025-08-13 10:38:04,596 - app.services.chatbot_service - INFO - Data and schema initialization completed
2025-08-13 10:38:04,596 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:38:11,812 - app.main - INFO - Shutting down FastAPI application...
2025-08-13 10:38:12,632 - app.services.chatbot_service - INFO - Starting background initialization...
2025-08-13 10:38:12,632 - app.services.database_service - INFO - Configured tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:38:12,660 - app.services.database_service - INFO - Database connection established
2025-08-13 10:38:12,660 - app.services.database_service - INFO - Processing table: 'fall_compliance_events' -> cleaned: 'fall_compliance_events'
2025-08-13 10:38:12,660 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_compliance_events'
2025-08-13 10:38:12,660 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:38:12,661 - app.main - INFO - Starting up FastAPI application...
2025-08-13 10:38:12,661 - app.main - INFO - Configuration validated successfully
2025-08-13 10:38:12,669 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-13 10:38:12,669 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:38:12,670 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-13 10:38:12,670 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:38:12,670 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-13 10:38:12,670 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-13 10:38:12,671 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:38:12,671 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_compliance_events" LIMIT 1000
2025-08-13 10:38:12,671 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:38:12,674 - app.services.database_service - INFO - Fetched 453 rows from table fall_compliance_events
2025-08-13 10:38:12,674 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:38:12,674 - app.services.database_service - INFO - Processing table: 'fall_incidents_primary' -> cleaned: 'fall_incidents_primary'
2025-08-13 10:38:12,674 - app.services.database_service - INFO - Attempting to fetch data from table: 'fall_incidents_primary'
2025-08-13 10:38:12,674 - app.services.database_service - INFO - Executing query: SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:38:12,675 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:38:12,675 - sqlalchemy.engine.Engine - INFO - SELECT * FROM "fall_incidents_primary" LIMIT 1000
2025-08-13 10:38:12,675 - sqlalchemy.engine.Engine - INFO - [generated in 0.00005s] ()
2025-08-13 10:38:12,677 - app.services.database_service - INFO - Fetched 77 rows from table fall_incidents_primary
2025-08-13 10:38:12,677 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:38:12,677 - app.services.database_service - INFO - Successfully fetched data from 2 tables: ['fall_compliance_events', 'fall_incidents_primary']
2025-08-13 10:38:12,680 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:38:12,680 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:38:12,680 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ('fall_compliance_events',)
2025-08-13 10:38:12,710 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_compliance_events"
2025-08-13 10:38:12,710 - sqlalchemy.engine.Engine - INFO - [generated in 0.00012s] ()
2025-08-13 10:38:12,711 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:38:12,711 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:38:12,711 - sqlalchemy.engine.Engine - INFO - 
                SELECT 
                    column_name,
                    data_type,
                    is_nullable,
                    column_default,
                    character_maximum_length
                FROM information_schema.columns 
                WHERE table_name = $1
                ORDER BY ordinal_position
            
2025-08-13 10:38:12,711 - sqlalchemy.engine.Engine - INFO - [cached since 0.03146s ago] ('fall_incidents_primary',)
2025-08-13 10:38:12,716 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) FROM "fall_incidents_primary"
2025-08-13 10:38:12,716 - sqlalchemy.engine.Engine - INFO - [generated in 0.00006s] ()
2025-08-13 10:38:12,716 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:38:12,716 - app.services.gemini_service - INFO - System prompt updated with database data and schema
2025-08-13 10:38:12,716 - app.services.chatbot_service - INFO - Data and schema initialization completed
2025-08-13 10:38:12,717 - app.services.chatbot_service - INFO - Background initialization completed successfully
2025-08-13 10:38:22,709 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:38:22,712 - app.services.chatbot_service - INFO - SQL query detected: SELECT
    TO_CHAR("DATE"::DATE, 'YYYY-MM') AS fall_month,
    COUNT("ID") AS number_of_falls
FROM
    fall_incidents_primary
GROUP BY
    fall_month
ORDER BY
    fall_month;
2025-08-13 10:38:22,712 - app.services.database_service - INFO - Executing SQL query: SELECT
    TO_CHAR("DATE"::DATE, 'YYYY-MM') AS fall_month,
    COUNT("ID") AS number_of_falls
FROM
    fall_incidents_primary
GROUP BY
    fall_month
ORDER BY
    fall_month;
2025-08-13 10:38:22,714 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:38:22,716 - sqlalchemy.engine.Engine - INFO - SELECT
    TO_CHAR("DATE"::DATE, 'YYYY-MM') AS fall_month,
    COUNT("ID") AS number_of_falls
FROM
    fall_incidents_primary
GROUP BY
    fall_month
ORDER BY
    fall_month;
2025-08-13 10:38:22,716 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] ()
2025-08-13 10:38:22,732 - app.services.database_service - INFO - Query executed successfully. Returned 3 rows
2025-08-13 10:38:22,733 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-13 10:38:51,480 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:38:51,484 - app.services.chatbot_service - INFO - SQL query detected: SELECT
    "NAME",
    COUNT(ID) AS total_falls
FROM
    fall_incidents_primary
GROUP BY
    "NAME"
ORDER BY
    total_falls ASC
LIMIT 1;
2025-08-13 10:38:51,484 - app.services.database_service - INFO - Executing SQL query: SELECT
    "NAME",
    COUNT(ID) AS total_falls
FROM
    fall_incidents_primary
GROUP BY
    "NAME"
ORDER BY
    total_falls ASC
LIMIT 1;
2025-08-13 10:38:51,485 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:38:51,486 - sqlalchemy.engine.Engine - INFO - SELECT
    "NAME",
    COUNT(ID) AS total_falls
FROM
    fall_incidents_primary
GROUP BY
    "NAME"
ORDER BY
    total_falls ASC
LIMIT 1;
2025-08-13 10:38:51,486 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] ()
2025-08-13 10:38:51,490 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 10:38:51,491 - app.services.database_service - ERROR - Error executing SQL query: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "id" does not exist
[SQL: SELECT
    "NAME",
    COUNT(ID) AS total_falls
FROM
    fall_incidents_primary
GROUP BY
    "NAME"
ORDER BY
    total_falls ASC
LIMIT 1;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 10:39:11,245 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyDhn5ZazCsZnDrs_UWdHZHNdwr7pAPTBvs "HTTP/1.1 200 OK"
2025-08-13 10:39:11,248 - app.services.chatbot_service - INFO - SQL query detected: SELECT
    "NAME",
    COUNT(ID) AS total_falls
FROM
    fall_incidents_primary
GROUP BY
    "NAME"
ORDER BY
    total_falls DESC
LIMIT 1;
2025-08-13 10:39:11,248 - app.services.database_service - INFO - Executing SQL query: SELECT
    "NAME",
    COUNT(ID) AS total_falls
FROM
    fall_incidents_primary
GROUP BY
    "NAME"
ORDER BY
    total_falls DESC
LIMIT 1;
2025-08-13 10:39:11,249 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-13 10:39:11,250 - sqlalchemy.engine.Engine - INFO - SELECT
    "NAME",
    COUNT(ID) AS total_falls
FROM
    fall_incidents_primary
GROUP BY
    "NAME"
ORDER BY
    total_falls DESC
LIMIT 1;
2025-08-13 10:39:11,250 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ()
2025-08-13 10:39:11,253 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-13 10:39:11,254 - app.services.database_service - ERROR - Error executing SQL query: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "id" does not exist
[SQL: SELECT
    "NAME",
    COUNT(ID) AS total_falls
FROM
    fall_incidents_primary
GROUP BY
    "NAME"
ORDER BY
    total_falls DESC
LIMIT 1;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-13 10:43:08,564 - app.main - INFO - Shutting down FastAPI application...
